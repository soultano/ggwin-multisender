<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>GGWIN Multisender</title>

  <!-- –ü–æ–¥–∫–ª—é—á–∞–µ–º —Å—Ç–∞–±–∏–ª—å–Ω—É—é –≤–µ—Ä—Å–∏—é UI -->
  <script src="https://unpkg.com/@tonconnect/ui@0.0.1-beta.20/dist/tonconnect-ui.min.js"></script>

  <style>
    body { font-family: Arial, sans-serif; padding: 20px; }
    textarea { width: 100%; height: 120px; margin-bottom: 10px; }
    button { padding: 10px 15px; margin-top: 5px; }
    #walletAddress { margin-top: 10px; font-weight: bold; }
  </style>
</head>
<body>
  <h1>GGWIN Multisender</h1>

  <button id="connectWalletBtn">üîå –ü–æ–¥–∫–ª—é—á–∏—Ç—å TON –ö–æ—à–µ–ª—ë–∫</button>
  <p id="walletAddress">–ö–æ—à–µ–ª—ë–∫ –Ω–µ –ø–æ–¥–∫–ª—é—á—ë–Ω</p>

  <textarea id="wallets" placeholder="–ê–¥—Ä–µ—Å–∞ –ø–æ–ª—É—á–∞—Ç–µ–ª–µ–π, –ø–æ –æ–¥–Ω–æ–º—É –Ω–∞ —Å—Ç—Ä–æ–∫—É"></textarea>
  <button id="sendBtn">–†–∞–∑–æ—Å–ª–∞—Ç—å 0.01 TON</button>

  <script>
    const tonConnect = new TonConnectUI.TonConnectUI({
      manifestUrl: "https://soultano.github.io/ggwin-multisender/tonconnect-manifest.json",
      buttonRootId: "connectWalletBtn"
    });

    const walletField = document.getElementById("wallets");
    const sendBtn = document.getElementById("sendBtn");
    const walletAddressDisplay = document.getElementById("walletAddress");

    tonConnect.onStatusChange(wallet => {
      if (wallet?.account?.address) {
        walletAddressDisplay.textContent = `–ö–æ—à–µ–ª—ë–∫: ${wallet.account.address}`;
      } else {
        walletAddressDisplay.textContent = "–ö–æ—à–µ–ª—ë–∫ –Ω–µ –ø–æ–¥–∫–ª—é—á—ë–Ω";
      }
    });

    sendBtn.addEventListener("click", async () => {
      const wallet = tonConnect.wallet;
      if (!wallet) {
        alert("–°–Ω–∞—á–∞–ª–∞ –ø–æ–¥–∫–ª—é—á–∏ –∫–æ—à–µ–ª—ë–∫!");
        return;
      }

      const addresses = walletField.value.split("\n").map(a => a.trim()).filter(Boolean);
      if (addresses.length === 0) {
        alert("–í—Å—Ç–∞–≤—å –∞–¥—Ä–µ—Å–∞ –ø–æ–ª—É—á–∞—Ç–µ–ª–µ–π!");
        return;
      }

      for (const to of addresses) {
        try {
          await tonConnect.sendTransaction({
            validUntil: Math.floor(Date.now() / 1000) + 300,
            messages: [
              {
                address: to,
                amount: "10000000" // 0.01 TON (–≤ nanotons)
              }
            ]
          });
          console.log(`‚úÖ –û—Ç–ø—Ä–∞–≤–ª–µ–Ω–æ –Ω–∞ ${to}`);
        } catch (e) {
          console.error(`‚ùå –û—à–∏–±–∫–∞ –Ω–∞ ${to}:`, e);
        }
      }
    });
  </script>
</body>
</html>
